function r(r,t,n,e,o){for(var i=0,f=0,u=0;u<o;u++)if(u!==n){for(var a=0;a<o;a++)a!==e&&(t[i][f]=r[u][a],++f);++i}}function t(r){for(var t=[],n=0;n<r;++n)t[n]=new Float32Array(r);return t}function n(e,o){if(1===o)return e[0][0];if(2===o)return e[0][0]*e[1][1]-e[0][1]*e[1][0];if(3===o)return e[0][0]*e[1][1]*e[2][2]+e[0][1]*e[1][2]*e[2][0]+e[0][2]*e[1][0]*e[2][1]-e[0][2]*e[1][1]*e[2][0]-e[0][1]*e[1][0]*e[2][2]-e[0][0]*e[1][2]*e[2][1];for(var i=1,f=0,u=t(o),a=0;a<o;++a)r(e,u,0,a,o),f+=i*e[0][a]*n(u,o-1),i=-i;return f}function e(e,o){var i=e.length,f=e[0],u=[];o=o||new Float32Array(i+1);for(var a=1;a<i;++a){for(var s=e[a],v=[],h=0;h<i;++h)v[h]=s[h]-f[h];u.push(v)}return function(e,o){var i=e[0].length;if(o=o||new Float32Array(i),3===i){var f=e[0],u=e[1],a=f[0],s=f[1],v=f[2],h=u[0],g=u[1],c=u[2];o[0]=s*c-v*g,o[1]=v*h-a*c,o[2]=a*g-s*h}else for(var l=i%2?-1:1,p=t(i),d=0;d<i;++d)r(e,p,i-1,d,i),o[d]=l*n(p,i-1),l=-l}(u,o),o[i]=-function(r,t){for(var n=r.length,e=r[0]*t[0],o=1;o<n;++o)e+=r[o]*t[o];return e}(f,o),function(r){for(var t=r.length,n=r[0]*r[0],e=1;e<t-1;++e)n+=r[e]*r[e];if(0===n)return r;for(n=1/Math.sqrt(n),e=0;e<t;++e)r[e]*=n}(o),o}function o(r,t){for(var n=r.length,e=t[n],o=0;o<n;++o)e+=r[o]*t[o];return e}function i(r,t){var n=r.pop();if(n===t)return r.length;var e=r.indexOf(t);if(-1===e)throw r.push(n),new Error("Removing component that's not present");return r[e]=n,e}var f=function(r){this.verts=[],this.facet=r},u=function(){function r(){this.outsideSet=[],this.outsideDist=[],this.ridges=[]}return r.prototype.getFurthestPoint=function(){var r=this.outsideSet,t=this.outsideDist,n=r.length;if(0===n)return-1;for(var e=r[0],o=t[0],i=1;i<n;++i)t[i]>o&&(o=t[i],e=r[i]);return e},r}();function a(r,t,n){var i=r.ridges.map((function(r){return t[r.verts[0]]})),f=r.plane=e(i);o(n,f)>0&&(!function(r){for(var t=r.length,n=0;n<t;++n)r[n]=-r[n]}(f),r.ridges.reverse(),r.ridges.forEach((function(r){return r.verts.reverse()})))}function s(r,t,n){for(var e=t.verts,o=e.length,i=0,f=n;i<f.length;i++)for(var u=0,a=f[i].ridges;u<a.length;u++){var s=a[u];if(!s.neighbor){for(var v=s.verts.indexOf(e[0]),h=v>=0,g=1;h&&g<o;)v=(v+1)%o,h=s.verts[v]==e[g],++g;if(h)return t.neighbor=s,void(s.neighbor=t)}}}function v(r,t,n){for(var e=n.map((function(r){return[]})),i=r.length,f=0;f<i;++f)for(var u=r[f],a=t[u],s=0,v=n;s<v.length;s++){var h=v[s],g=o(a,h.plane);if(g>0){h.outsideSet.push(u),h.outsideDist.push(g);break}}return e}function h(r,t,n,e){n.push(t),t.currentPoint=r;for(var i=0,f=t.ridges;i<f.length;i++){var u=f[i],a=u.neighbor.facet;a.currentPoint!==r&&(o(r,a.plane)>0?h(r,a,n,e):e.push(u))}}function g(r,t,n,e,o,i){var v=new u,h=r.verts.slice();h.push(t),v.ridges.push(r),r.facet=v;for(var g=1;g<i;++g){for(var c=new f(v),l=0;l<i-1;++l)c.verts[l]=h[(g+l)%i];s(0,c,e),v.ridges.push(c)}return a(v,n,o),v}function c(r,t,n,e,o){for(var i=[],f=0,u=n;f<u.length;f++){var a=g(u[f],t,r,i,e,o);i.push(a)}return i}function l(r){if(0!==r.length){var t=function(r){return r.length}(r[0]);r.length<=t&&console.log("A convex hull in "+t+" dimensions requires at least "+(t+1)+" points.");for(var n=r[0].slice(),e=0;e<t;++e){for(var o=1;o<=t;++o)n[e]+=r[o][e];n[e]/=t+1}var g=function(r,t,n){for(var e=[],o=t+1,i=[],v=0;v<=t;++v){for(var h=new u,g=0;g<t;++g)i[g]=(v+g)%o;for(var c=0;c<t;++c){var l=h.ridges[c]=new f(h);for(g=0;g<t-1;++g)l.verts[g]=i[(c+g)%t];s(0,l,e)}a(h,r,n),e.push(h)}return e}(r,t,n),l=[];for(o=t+1;o<r.length;++o)l.push(o);v(l,r,g);for(var p=!1;!p;){p=!0;for(o=0;o<g.length;++o){var d=g[o],w=d.getFurthestPoint();if(-1!==w){i(d.outsideSet,w);var S=[],b=[];h(r[w],d,S,b);for(var m=c(r,w,b,n,t),y=0,F=S;y<F.length;y++){var x=F[y];i(g,x)<=o&&--o,v(x.outsideSet,r,m),x.outsideSet.length>0&&(p=!1)}g.push.apply(g,m)}}}return g}}export{l as quickHull};
