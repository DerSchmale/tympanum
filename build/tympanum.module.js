function r(r,t,e,n,o){for(var i=0,a=0,f=0;f<o;f++)if(f!==e){for(var u=0;u<o;u++)u!==n&&(t[i][a]=r[f][u],++a);++i}}function t(r){for(var t=[],e=0;e<r;++e)t[e]=new Float32Array(r);return t}function e(n,o){if(1===o)return n[0][0];if(2===o)return n[0][0]*n[1][1]-n[0][1]*n[1][0];if(3===o)return n[0][0]*n[1][1]*n[2][2]+n[0][1]*n[1][2]*n[2][0]+n[0][2]*n[1][0]*n[2][1]-n[0][2]*n[1][1]*n[2][0]-n[0][1]*n[1][0]*n[2][2]-n[0][0]*n[1][2]*n[2][1];for(var i=1,a=0,f=t(o),u=0;u<o;++u)r(n,f,0,u,o),a+=i*n[0][u]*e(f,o-1),i=-i;return a}function n(n,o){var i=n.length,a=n[0],f=[];o=o||new Float32Array(i+1);for(var u=1;u<i;++u){for(var v=n[u],s=[],h=0;h<i;++h)s[h]=v[h]-a[h];f.push(s)}return function(n,o){var i=n[0].length;if(o=o||new Float32Array(i),3===i){var a=n[0],f=n[1],u=a[0],v=a[1],s=a[2],h=f[0],l=f[1],g=f[2];o[0]=v*g-s*l,o[1]=s*h-u*g,o[2]=u*l-v*h}else for(var c=i%2?-1:1,p=t(i),d=0;d<i;++d)r(n,p,i-1,d,i),o[d]=c*e(p,i-1),c=-c}(f,o),o[i]=-function(r,t){for(var e=r.length,n=r[0]*t[0],o=1;o<e;++o)n+=r[o]*t[o];return n}(a,o),function(r){for(var t=r.length,e=r[0]*r[0],n=1;n<t-1;++n)e+=r[n]*r[n];if(0===e)return r;for(e=1/Math.sqrt(e),n=0;n<t;++n)r[n]*=e}(o),o}function o(r,t){for(var e=r.length,n=t[e],o=0;o<e;++o)n+=r[o]*t[o];return n}function i(r,t){var e=r.pop();if(e===t)return r.length;var n=r.indexOf(t);if(-1===n)throw r.push(e),new Error("Removing component that's not present");return r[n]=e,n}var a=function(r){this.verts=[],this.facet=r},f=function(){this.ridges=[]};function u(r,t,e){for(var n=t.verts,o=n.length,i=0,a=e;i<a.length;i++)for(var f=0,u=a[i].ridges;f<u.length;f++){var v=u[f];if(!v.neighbor){for(var s=v.verts.indexOf(n[0]),h=s>=0,l=1;h&&l<o;)s=(s+1)%o,h=v.verts[s]==n[l],++l;if(h)return t.neighbor=v,void(v.neighbor=t)}}}function v(r,t,e){var i=r.ridges.map((function(r){return t[r.verts[0]]})),a=r.plane=n(i);if(e&&o(e,a)>0){!function(r){for(var t=r.length,e=0;e<t;++e)r[e]=-r[e]}(a),r.ridges.reverse();for(var f=0,u=r.ridges;f<u.length;f++){u[f].verts.reverse()}}}function s(r,t){for(var e=[],n=t+1,o=[],i=0;i<=t;++i){for(var s=new f,h=0;h<t;++h)o[h]=(i+h)%n;for(var l=0;l<t;++l){var g=s.ridges[l]=new a(s);for(h=0;h<t-1;++h)g.verts[h]=o[(l+h)%t];u(0,g,e)}v(s,r,r[(i+t)%(t+1)]),e.push(s)}return e}var h=function(){this.outsideSet=[],this.outsideDist=[]};function l(r){var t=r.meta,e=t.outsideSet,n=t.outsideDist,o=e.length;if(0===o)return-1;for(var i=e[0],a=n[0],f=1;f<o;++f)n[f]>a&&(a=n[f],i=e[f]);return i}function g(r,t,e){for(var n=e.map((function(r){return[]})),i=r.length,a=0;a<i;++a)for(var f=r[a],u=t[f],v=0,s=e;v<s.length;v++){var h=s[v],l=o(u,h.plane);if(l>0){var g=h.meta;g.outsideSet.push(f),g.outsideDist.push(l);break}}return n}function c(r,t,e,n){e.push(t),t.meta.currentPoint=r;for(var i=0,a=t.ridges;i<a.length;i++){var f=a[i],u=f.neighbor.facet;u.meta.currentPoint!==r&&(o(r,u.plane)>0?c(r,u,e,n):n.push(f))}}function p(r,t,e,n,o,i){var s=new f;s.meta=new h;var l=r.verts.slice();l.push(t),s.ridges.push(r),r.facet=s;for(var g=1;g<i;++g){for(var c=new a(s),p=0;p<i-1;++p)c.verts[p]=l[(g+p)%i];u(0,c,n),s.ridges.push(c)}return v(s,e,o),s}function d(r,t,e,n,o){for(var i=[],a=0,f=e;a<f.length;a++){var u=p(f[a],t,r,i,n,o);i.push(u)}return i}function m(r){if(0!==r.length){var t=function(r){return r.length}(r[0]);r.length<=t&&console.log("A convex hull in "+t+" dimensions requires at least "+(t+1)+" points.");for(var e=s(r,t),n=0,o=e;n<o.length;n++){o[n].meta=new h}for(var a=function(r,t){for(var e=r[0].slice(),n=0;n<t;++n){for(var o=1;o<=t;++o)e[n]+=r[o][n];e[n]/=t+1}return e}(r,t),f=[],u=t+1;u<r.length;++u)f.push(u);g(f,r,e);for(var v=!1;!v;){v=!0;for(u=0;u<e.length;++u){var p=e[u],m=l(p);if(-1!==m){i(p.meta.outsideSet,m);var w=[],S=[];c(r[m],p,w,S);for(var b=d(r,m,S,a,t),x=0,y=w;x<y.length;x++){var A=y[x];i(e,A)<=u&&--u,g(A.meta.outsideSet,r,b),A.meta.outsideSet.length>0&&(v=!1)}e.push.apply(e,b)}}}for(var D=0,F=e;D<F.length;D++){F[D].meta=null}return e}}export{f as Facet,a as Ridge,s as createSimplex,m as quickHull};
